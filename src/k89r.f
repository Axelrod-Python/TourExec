      FUNCTION K89R(HCM,MN,MYSC,HSC,RANDOM,JA)
C BY GENE SNODGRASS
C FROM CARDS BY JM 3/22/79
      IMPLICIT INTEGER(A-Q,S-Z)
      DIMENSION SC(6),SL(6),ST(5),GT(5),TM(6)
      K89R=JA       ! Added 7/32/93 to report own old value
      IF(.NOT.(MN.EQ.1))GOTO 23010
      DO 23012I=1,5
      GT(I)=0
      TM(I)=0
      SL(I)=1
23012 CONTINUE
23013 CONTINUE
      CN=10
      TM(6)=0
      SL(6)=1
      CSRC=5
      MYLM=1
      HLM=0
23010 CONTINUE
23014 CONTINUE
      CODE=CN/10
      IF(.NOT.(10*CODE.EQ.CN))GOTO 23017
      SC(CODE)=MYSC
23017 CONTINUE
      IF(.NOT.(SL(CODE).EQ.1))GOTO 23019
      CN=CN+1
      TM(CODE)=TM(CODE)+1
      GOTO(10,20,30,40,50,60),CODE
10    K89R=0
      RETURN
20    K89R=1
      RETURN
30    K89R=1-MYLM
      MYLM=K89R
      RETURN
40    IF(.NOT.(HCM.EQ.1))GOTO 23021
      K89R=1
      GOTO 23022
23021 CONTINUE
      K89R=0
23022 CONTINUE
      RETURN
50    IF(.NOT.(HCM.EQ.1.AND.HLM.EQ.1))GOTO 23023
      K89R=1
      GOTO 23024
23023 CONTINUE
      K89R=0
23024 CONTINUE
      HLM=HCM
      RETURN
60    SGT=0
      DO 23025I=1,5
      ST(I)=SC(I+1)-SC(I)
      SGT=SGT+ST(I)
      GT(I)=GT(I)+ST(I)
23025 CONTINUE
23026 CONTINUE
      MEAN=SGT/CSRC
      AMEAN=9*MEAN/10
      CSRC=0
      DO 23027I=1,5
      IF(.NOT.(SL(I).EQ.1))GOTO 23029
      IF(.NOT.(ST(I).LT.AMEAN))GOTO 23031
      SL(I)=0
23031 CONTINUE
      GOTO 23030
23029 CONTINUE
      IF(.NOT.(10*GT(I)/TM(I).GT.AMEAN))GOTO 23033
      SL(I)=1
23033 CONTINUE
23030 CONTINUE
      IF(.NOT.(SL(I).EQ.1))GOTO 23035
      CSRC=CSRC+1
23035 CONTINUE
23027 CONTINUE
23028 CONTINUE
      CN=10
      GOTO 23020
23019 CONTINUE
      CN=CN+10
23020 CONTINUE
23015 GOTO 23014
      END
